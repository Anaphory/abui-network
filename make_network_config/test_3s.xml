<?xml version='1.0' encoding='UTF-8'?>
<beast namespace="beast.core:beast.core.util:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.branchratemodel:beast.evolution.likelihood" version="2.4">
    <data id="gene1" name="alignment">
        <sequence taxon="kira1248" value="CTCTTGTGGACGCCATCGCCGATATTCCAGCAGACAGAAGGCAATGCAGAAGAACGCCGATAGTACAAGTACGGTTAAGCTTTATCTATTGGTCGCATGCGTCCGCTATTCTCTTCCGTACCGTTTCCCGCACGGCAATACCGTAGGAAAGTGAAAAAAAAGTTACACCCCTAACCGTGATCTGGCAACATTCTACTAGT"/>
        <sequence taxon="kuii1253" value="CTCTTGTGGACGCCATCGCCGATATTCCAGCAGACAGAGGGCAATGCAGAAGAACGCCGATAGTACAAGTCCGGTTAAGCTTTATCTACTGGTCGCATGCGTCCGCTATTCTCTTCCGTACCGGTTCCCACACGGCAATTCCGTTGGAAAGTGAAAAAAAAGATACACCCCTAACCGAGATCTGGCAACATTCTACTAGT"/>
        <sequence taxon="abui1241-fuime" value="CTCTTGTGGACGGCATCGCCGATAGTCCATCGGTCAGGATGCAATGCAGAAGTACGACGATAGTATAAGTACGGTTAAGCTTTATCTACGGGTCGGATGCGTCTGCTATTATCTTCCGTAACGGTTACCGCTCGGCAATTTCGTTGGAAAGTGGAAATAAAGGTAGACCCTTAAGCGTGATTCGGCAAAATTCTACTCGT"/>
        <sequence taxon="atim1239" value="CTATTGTGGACGCCATCGCCGATAGTCCAGCGGACAGAAGGCAATGCAGAAGAACGCCGATAGTACAAGTACGATTAAGCTCTATCTATTGGTCGCATGCCTCCGCTATTCTCTTGCGTACCGTTTCCCACAAGGCAATTCCGTTGGAAAGTGAAAAAAAAGATACACCCTTAACCGTGATTTGGCAACATTCTACTAGT"/>
        <sequence taxon="kelo1247-bring" value="GTTTTGTCGACGGCATCGCCGAGATACCATCAGACACAAGGCAATGCAGAAGTAGGACGACAGTATAAATACGGTCAAGCTTTATCAATTGGTCGGATGCGTCCGCTATAATCTTCCGTACCCTTTACCACTCGCGAATTCGGTTGGAAAGTGGAAAAAAAGGTACACCCTTACGCGTGATTCGGCAAAATTCTATTCGT"/>
        <sequence taxon="kelo1247-hopte" value="CTCTGGTGGAGGCCATCCCCGATATTCCAGCGAACAGAAAGCAATGCAGAAGTACGACGTTAGTATAAGTACGGTTAAGATTTATCTATTGGTCGCATGCGTCCCCTATTCTGTTCCGTACCATTTCCGACACGGCAAACCCGTTGGAAAGTGGAAAAAAAGATAGAGCCTTAACCGTGATTTGGCAACATTCTACTAGT"/>
    </data>
    <data id="gene2" name="alignment">
        <sequence taxon="kira1248" value="CACAGTGTCTATCCCAGTCCACTTCACCGCCAAATAGGCGTCGTAGAGTCGGGGATTGTTCGTTGACAAAGGAACTATTATAACATCCTCGGATCACAAGGTACATCGTATTCAATGGTCATTTAGTCGGAGCTGGCGACCTAGGGAGAAAAGCATTTTGAGGAAGCCCACCCACTAAATTCCTAACCAGTTATTGCATT"/>
        <sequence taxon="abui1241-fuime" value="CATAGTGTCTATCCCAGTCCACTTCAGCGTCAAACAGGCGTAGTAGAGTCGGGGATGGTTCGTGGGCAAAGGAACTATTATGACGTCCTGGGATGCCAAGGTACCTTGTAGTCAATGGTCATTTAGTCGGAGCTGGCGACCTAGGGAGAAACGCATTGTGACGAAGCCCACCCGCTAACTTCCTAACCAGTTCTTGACCT"/>
        <sequence taxon="atim1239" value="CACAGTGTCTATCCCAGTCCACTTCACCGTCAAATAGGCGTCGTAGAGTCGGGGATTGTTCGTTGACAAAGGAACTATTATAACTACCTCGGATCACAAGGTACATTGTATTCAATGGTCATTTAGTCGGAGCTGGCGACCTAGGGAGAAAAGCATTTTGAGGAAGCCCACCCACTAAATTCCTAACCAGTTATTGCATT"/>
        <sequence taxon="abui1241-takal" value="CACAGTGTCTATCCCAGTCCACTTCACCGTCAAATAGGCGTCGTAGAGTCGGGGATTGTTCGTTGACAAAGGAACTATTATAACTACCTCGGATCACAAGGTACATTGTATTCAATGGTCATTTAGTCGGAGCTGGCGACCTAGGGAGAAAAGCATTTTGAGGAAGCCCACCCACTAAATTCCTAACCAGTTATTGCATT"/>
        <sequence taxon="abui1241-ulaga" value="CATAGTGTCTATCCCAGTCCACTTCAGCGTCAAACAGGCGTAGTAGAGTCGGGGATGGTTCGTGGACAAAGGAACTATTATGAGGTCCTGGGAAGCCAAGGTACCTTATAGTCAATGGTCATTTAGTCGGAGCTGTCGACCTAGGGAGAAACGCATTGTGACGAAGCTCACCCGCTAACTTCCTAACCAGTTCTTGAACT"/>
        <sequence taxon="kelo1247-bring" value="CATAGTGTCTATGCCAGTCAACTTCAACATCAAACAGGCGTCGAAGAGTCGGGGATTGTTCGTTGACAAAGGAACTATTATAACGTCATCGGATGGCAAGGTACGTTGTACTCAATCGTCATTTAGTCGGAGCTGGCGACCTAGCGAGAAAAGCAATTTGAGGAAGCCCACCCACTAAATTCCTAACCAGTTATTTCACT"/>
    </data>
    <data id="gene3" name="alignment">
        <sequence taxon="kira1248" value="TATAGACGAACCGGCCTACTTTACAAGAACCCACTATCGGGAGATCTTCTCTGGAATTATTTGTTACCATCGTTAACATTGCGGGTCCTCCCTGGTCCCTAGCATATAACCCTTAGTTTAGTCATATTCGAAGCTCATCGGTTTAATACCGTTCCGTTACAAGCCTTCATACTACGGATCTCCTTTTTTGAAGCTTCTAT"/>
        <sequence taxon="kuii1253" value="GATAGACGAACCGGCCTACATTACAAGAATCCACTATACGGAGATCTTCTCTAGAATTATTCGTCACCATCGTGAACATTGCAGCTTCTCCCTGGTCCCTAGCATATAACCCTTAGTTTGGACATGTTCGGAGCTCATCGGTTTAATAGCGCTCCGTTACCAGCCTTCATACTACGGATCTCCTTTTTTGAAGCTTCTAT"/>
        <sequence taxon="abui1241-fuime" value="GATCGACGAACCGGCCTACATTACAAGAACCCACTATAGGGAGATCTTCTCTGGAATTAATCGTTACCATCGTAAACATTGCAGCTCCTCCTTGGTCCCTAGCATATAACCCTTTGTTTAGACATATTCGAAGCTCATCGGTTTAATACGGTTCCGTTACCATCCTTCATACTACGGATCTCCTTTTTTGGAGGTTCTAT"/>
        <sequence taxon="atim1239" value="GATCGACGAACCGGCCTACATTACAAGAACCCACTATAGGGAGATCTTCTCTGGAATTATTCGTTACCATCGTGAACATTGCAGCTCCTCCTTGGTCCCTAGCATATAACCCTTTGTTTAGACATATTCGAAGCTCATCGGTTTAATACGGTTCCGTTACCATCCTTCATACTACGGATCTCCTTTTTTGAAGGTTCTAT"/>
        <sequence taxon="abui1241-takal" value="CATAGACTGAGCGGCCTTCATTACAAGACCCCACTATCGGTAGATCTATTCTAGAATTATTCGTAACCATCGTGAACCTTGTAGCTCCTCCCTGGTCCCTAGCATATAACCCTTAGTTTAGACATATTCGAAGCTCATCGGTTTATCACCGTTCCGGTACCATCCTCCATCCTACGGATCTCCTATTTTGATACTTCTAT"/>
        <sequence taxon="kelo1247-bring" value="GATAGACGGACCGGCCTACATTACAAGAACCCACTATCGGGAGATCTACTCTAGAATTATTCGTTACCATCGGGAACCTTGGAGCTCCTCCCTGGTCCCTAGCGTATAACCCTTAGTTTAGTCATATTCGAAGCTGATCGTTTTAACATCGTTCCGGTACCATTCTTCATACTACGGATCTCCTATTTTGAAGCTTCTAT"/>
        <sequence taxon="kelo1247-hopte" value="CTTCGACCGACCGGCCTACATGACACGAACCCACGATCGGTAGATCTACTCTAGAATTATTCGTAACTATCGTCAACCTTGCAGCTCCTCCCTGGTCCCTAGGATATAACCCTTAGTGTAGTCATATTCGAAGCTCATCACTTTAACACAGTTCCGGTACCATCCTCCATCCTACGGATCTCCTTTCTTGATGCTTCTAT"/>
    </data>

    <map name="Uniform">beast.math.distributions.Uniform</map>
    <map name="Exponential">beast.math.distributions.Exponential</map>
    <map name="LogNormal">beast.math.distributions.LogNormalDistributionModel</map>
    <map name="Normal">beast.math.distributions.Normal</map>
    <map name="Beta">beast.math.distributions.Beta</map>
    <map name="Gamma">beast.math.distributions.Gamma</map>
    <map name="LaplaceDistribution">beast.math.distributions.LaplaceDistribution</map>
    <map name="InverseGamma">beast.math.distributions.InverseGamma</map>
    <map name="OneOnX">beast.math.distributions.OneOnX</map>
    <map name="prior">beast.math.distributions.Prior</map>

    <init spec="beast.util.TreeParser" id="newick:species" IsLabelledNewick="true" adjustTipHeights="false"
          newick="(((KiraKui:0.02,(Abui:0.01)#H1[&amp;gamma=0.3]:0.01)S1:0.03,(#H1:0.02,Klon:0.03)S2:0.02)R:0.05)"/>
    <run id="mcmc" spec="MCMC" chainLength="2000000" storeEvery="10000">
        <state id="state">
            <stateNode id="network:species" spec="speciesnetwork.NetworkParser" tree="@newick:species">
                <taxonset id="taxonsuperset" spec="TaxonSet">
                    <taxon id="KiraKui" spec="TaxonSet">
                        <taxon id="kira1248" spec="Taxon"/>
                        <taxon id="kuii1253" spec="Taxon"/>
                    </taxon>
                    <taxon id="Abui" spec="TaxonSet">
                        <taxon id="abui1241-fuime" spec="Taxon"/>
                        <taxon id="atim1239" spec="Taxon"/>
                        <taxon id="abui1241-takal" spec="Taxon"/>
                        <taxon id="abui1241-ulaga" spec="Taxon"/>
                    </taxon>
                    <taxon id="Klon" spec="TaxonSet">
                        <taxon id="kelo1247-bring" spec="Taxon"/>
                        <taxon id="kelo1247-hopte" spec="Taxon"/>
                    </taxon>
                </taxonset>
            </stateNode>
            <parameter id="originTime:species" lower="0.0" name="stateNode">0.1</parameter>
            <parameter id="netDivRate:species" lower="0.0" name="stateNode">2.0</parameter>
            <parameter id="turnOverRate:species" lower="0.0" upper="1.0" name="stateNode">0.5</parameter>
            <stateNode id="tree:gene1" spec="speciesnetwork.EmbeddedTree">
                <taxonset id="taxonset:gene1" spec="TaxonSet" alignment="@gene1"/>
            </stateNode>
            <stateNode id="tree:gene2" spec="speciesnetwork.EmbeddedTree">
                <taxonset id="taxonset:gene2" spec="TaxonSet" alignment="@gene2"/>
            </stateNode>
            <stateNode id="tree:gene3" spec="speciesnetwork.EmbeddedTree">
                <taxonset id="taxonset:gene3" spec="TaxonSet" alignment="@gene3"/>
            </stateNode>
        </state>

        <init id="SNI" spec="speciesnetwork.SpeciesNetworkInitializer" estimate="false" method="random" speciesNetwork="@network:species" origin="@originTime:species">
          <plate range="gene1,gene2,gene3" var="gene">
            <geneTree idref="tree:$(gene)"/>
          </plate>
            <rebuildEmbedding id="initEmbed" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="0.0">
              <plate range="gene1,gene2,gene3" var="gene">
                <geneTree idref="tree:$(gene)"/>
              </plate>
            </rebuildEmbedding>
        </init>

        <distribution id="posterior" spec="util.CompoundDistribution">
            <distribution id="coalescent" spec="speciesnetwork.MultispeciesCoalescent" speciesNetwork="@network:species">
              <plate range="gene1,gene2,gene3" var="gene">
                <geneTreeWithin id="geneTree:$(gene)" spec="speciesnetwork.GeneTreeInSpeciesNetwork" speciesNetwork="@network:species" geneTree="@tree:$(gene)"/>
              </plate>
                <populationModel id="popModel" alpha="4.0" beta="0.04" spec="speciesnetwork.ConstantPopIntegrated"/>
            </distribution>
            <distribution id="prior" spec="util.CompoundDistribution">
                <distribution id="networkPrior" spec="speciesnetwork.BirthHybridizationModel" network="@network:species" netDiversification="@netDivRate:species" turnOver="@turnOverRate:species" betaShape="1.0"/>
                <prior id="networkOrigin" name="distribution" x="@originTime:species">
                    <Exponential id="exponential.0" name="distr" mean="0.1"/>
                </prior>
                <prior id="netDivPrior" name="distribution" x="@netDivRate:species">
                    <Exponential id="exponential.01" name="distr" mean="10.0"/>
                </prior>
                <prior id="turnOverPrior" name="distribution" x="@turnOverRate:species">
                    <Beta id="betadistr.01" name="distr" alpha="1.0" beta="1.0"/>
                </prior>
            </distribution>
            <distribution id="likelihood" spec="util.CompoundDistribution">
              <plate range="gene1,gene2,gene3" var="gene">
                <distribution id="likelihood:$(gene)" data="@$(gene)" tree="@tree:$(gene)" spec="TreeLikelihood">
                    <siteModel id="siteModel:$(gene)" mutationRate="1.0" spec="SiteModel">
                        <substModel id="jc:$(gene)" spec="JukesCantor"/>
                    </siteModel>
                    <branchRateModel id="strictClock:$(gene)" clock.rate="1.0" spec="StrictClockModel"/>
                </distribution>
              </plate>
            </distribution>
        </distribution>

      <plate range="gene1,gene2,gene3" var="gene">
        <operator id="scaleAndEmbed:$(gene)" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="3.0">
            <geneTree idref="tree:$(gene)"/>
            <operator id="scale:$(gene)" spec="ScaleOperator" scaleFactor="0.5" tree="@tree:$(gene)" weight="0.0"/>
        </operator>
        <operator id="scaleRootAndEmbed:$(gene)" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="3.0">
            <geneTree idref="tree:$(gene)"/>
            <operator id="scaleRoot:$(gene)" spec="ScaleOperator" rootOnly="true" scaleFactor="0.5" tree="@tree:$(gene)" weight="0.0"/>
        </operator>
        <operator id="uniformAndEmbed:$(gene)" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="30.0">
            <geneTree idref="tree:$(gene)"/>
            <operator id="uniform:$(gene)" spec="Uniform" tree="@tree:$(gene)" weight="0.0"/>
        </operator>
        <operator id="subSlideAndEmbed:$(gene)" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="15.0">
            <geneTree idref="tree:$(gene)"/>
            <operator id="subSlide:$(gene)" spec="SubtreeSlide" tree="@tree:$(gene)" weight="0.0"/>
        </operator>
        <operator id="narrowAndEmbed:$(gene)" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="15.0">
            <geneTree idref="tree:$(gene)"/>
            <operator id="narrow:$(gene)" spec="Exchange" tree="@tree:$(gene)" weight="0.0"/>
        </operator>
        <operator id="wideAndEmbed:$(gene)" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="5.0">
            <geneTree idref="tree:$(gene)"/>
            <operator id="wide:$(gene)" spec="Exchange" isNarrow="false" tree="@tree:$(gene)" weight="0.0"/>
        </operator>
        <operator id="WilsonBaldingAndEmbed:$(gene)" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="5.0">
            <geneTree idref="tree:$(gene)"/>
            <operator id="WilsonBalding:$(gene)" spec="WilsonBalding" tree="@tree:$(gene)" weight="0.0"/>
        </operator>
      </plate>

        <operator id="divrRateScale:species" spec="ScaleOperator" parameter="@netDivRate:species" scaleFactor="0.5" weight="10.0"/>
        <operator id="turnOverScale:species" spec="ScaleOperator" parameter="@turnOverRate:species" scaleFactor="0.5" weight="10.0"/>
        <operator id="gammaProbUniform:species" spec="speciesnetwork.operators.GammaProbUniform" speciesNetwork="@network:species" weight="20.0"/>
        <operator id="gammaProbRndWalk:species" spec="speciesnetwork.operators.GammaProbRndWalk" speciesNetwork="@network:species" weight="20.0"/>

        <operator id="networkMultiplier:species" spec="speciesnetwork.operators.NetworkMultiplier" speciesNetwork="@network:species" origin="@originTime:species" weight="10.0">
          <plate range="gene1,gene2,gene3" var="gene">
            <geneTree idref="tree:$(gene)"/>
          </plate>
        </operator>
        <operator id="originMultiplier:species" spec="speciesnetwork.operators.OriginMultiplier" speciesNetwork="@network:species" origin="@originTime:species" weight="5.0"/>
        <operator id="coordNodeUniformAndEmbed:species" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="80.0">
          <plate range="gene1,gene2,gene3" var="gene">
            <geneTree idref="tree:$(gene)"/>
          </plate>
            <operator id="coordNodeUniform:species" spec="speciesnetwork.operators.CoordinatedNodeUniform" speciesNetwork="@network:species" weight="0.0">
              <plate range="gene1,gene2,gene3" var="gene">
                <geneTree idref="tree:$(gene)"/>
              </plate>
            </operator>
        </operator>
        <operator id="nodeSliderAndEmbed:species" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="80.0">
          <plate range="gene1,gene2,gene3" var="gene">
            <geneTree idref="tree:$(gene)"/>
          </plate>
            <operator id="nodeSlider:species" spec="speciesnetwork.operators.NodeSlider" speciesNetwork="@network:species" origin="@originTime:species" isNormal="true" sigma="0.005" weight="0.0"/>
        </operator>

        <operator id="relocateBranchAndEmbed:species" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="150.0">
          <plate range="gene1,gene2,gene3" var="gene">
            <geneTree idref="tree:$(gene)"/>
          </plate>
            <operator id="relocateBranch:species" spec="speciesnetwork.operators.RelocateBranch" speciesNetwork="@network:species" weight="0.0"/>
        </operator>
        <operator id="flipReticulationAndEmbed:species" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="15.0">
          <plate range="gene1,gene2,gene3" var="gene">
            <geneTree idref="tree:$(gene)"/>
          </plate>
            <operator id="flipReticulation:species" spec="speciesnetwork.operators.FlipReticulation" speciesNetwork="@network:species" weight="0.0"/>
        </operator>
        <operator id="addReticulationAndEmbed:species" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="80.0">
          <plate range="gene1,gene2,gene3" var="gene">
            <geneTree idref="tree:$(gene)"/>
          </plate>
            <operator id="addReticulation:species" spec="speciesnetwork.operators.AddReticulation" speciesNetwork="@network:species" weight="0.0"/>
        </operator>
        <operator id="deleteReticulationAndEmbed:species" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="80.0">
          <plate range="gene1,gene2,gene3" var="gene">
            <geneTree idref="tree:$(gene)"/>
          </plate>
            <operator id="deleteReticulation:species" spec="speciesnetwork.operators.DeleteReticulation" speciesNetwork="@network:species" weight="0.0"/>
        </operator>

        <logger id="screenlog" logEvery="10000" model="@posterior">
            <log idref="posterior"/>
            <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
            <log idref="likelihood"/>
            <log idref="prior"/>
            <log idref="coalescent"/>
        </logger>
        <logger id="tracelog" fileName="test_3s.xml.trace.log" logEvery="1000" model="@posterior" sort="smart">
            <log idref="posterior"/>
            <log idref="likelihood"/>
            <log idref="prior"/>
            <log idref="coalescent"/>
            <log idref="netDivRate:species"/>
            <log idref="turnOverRate:species"/>
            <log idref="originTime:species"/>
            <log id="height:species" speciesNetwork="@network:species" spec="speciesnetwork.NetworkStatLogger"/>
          <plate range="gene1,gene2,gene3" var="gene">
            <log id="height:$(gene)" tree="@tree:$(gene)" spec="beast.evolution.tree.TreeStatLogger"/>
          </plate>
        </logger>
        <logger id="specieslog" fileName="test_3s.xml.species.trees" logEvery="1000" mode="tree">
            <log id="networkLogger:species" spec="speciesnetwork.NetworkWithMetaDataLogger" speciesNetwork="@network:species"/>
        </logger>
      <plate range="gene1,gene2,gene3" var="gene">
        <logger id="treelog:$(gene)" fileName="test_3s.xml.$(gene).trees" logEvery="1000" mode="tree">
            <log id="treeLogger:$(gene)" tree="@tree:$(gene)" spec="beast.evolution.tree.TreeWithMetaDataLogger"/>
        </logger>
      </plate>
    </run>
</beast>
