<?xml version='1.0' encoding='UTF-8'?>
<beast namespace="beast.core:beast.core.util:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.branchratemodel:beast.evolution.likelihood" version="2.4">
    <data id="gene1" name="alignment" dataType="twoStateCovarion">
        <sequence taxon="a1" value="10100?0??"/>
        <sequence taxon="a2" value="10100?0??"/>
        <sequence taxon="b1" value="10100?0??"/>
        <sequence taxon="b2" value="10000?0??"/>
        <sequence taxon="b3" value="?????????"/>
        <sequence taxon="b4" value="?????????"/>
        <sequence taxon="c1" value="?0000?01?"/>
        <sequence taxon="c2" value="1010??0??"/>
    </data>
    <data id="gene2" name="alignment" dataType="twoStateCovarion">
        <sequence taxon="a1" value="1010?0?010001110?01101001011?1100000??1?01?00?0?01????000?001?00?010000001001101??0010100??001001?00001000??0100000?01??0?10??1?01100???0?0000?100000?0??00?11101110100000011000110?00000?1000"/>
        <sequence taxon="a2" value="??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????"/>
        <sequence taxon="b1" value="1000?0?010001110?011010010?1?0100010??1?00?00?0?01????00??001?0???10000?01?0110???00?1100??001100?00?01000??0100000?01??0?10??1?01100???0?0001?1000?0?01?00?1110111?100010011000110?00100?0110"/>
        <sequence taxon="b2" value="1010?0?010001110?01101001011?0100000??1?01?00?0?01????000?001?00?010000001001101??0010100??001000?00001000??0100000?01??0?10??1?01100???0?0000?100000?0??00?11101110100000011000110?00000?1000"/>
        <sequence taxon="b3" value="1010?0?010001110?01101001011?0100000??1?01?00?0?01????000?001?00?010000001001101??0010100??001000?00001000??0100000?01??0?10??1?01100???0?0000?100000?0??00?11101110100000011000110?00000?1000"/>
        <sequence taxon="b4" value="1000?0?010001110?011010010?1?0100010??1?00?00?0?01????00??001?0??010000?0??0110???00?1100??001100000?01000??0100000?01??0?10?01?01100???0?0001?1000?0?01?00?1010111?100010011000110?00100?0010"/>
        <sequence taxon="c1" value="1000?0?01000?110?0100100100100100010??1?01?00?0?01????000?001?00?010000001?01001??00??100??001?00?001010001?0100000?01??0?10??1?01100?1?0?0000?100000?0??00?11101110100000011000110?0000001010"/>
        <sequence taxon="c2" value="??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????"/>
    </data>
    <data id="gene3" name="alignment" dataType="twoStateCovarion">
        <sequence taxon="a1" value="0000?01?0011??110010000100?00111010001???0?001001010??00000000?0001000?1???01101110??011100?1000000111000?0000?01000001?00?101001??000000011?0011?000100?110010001001??001011000000?00?1001000"/>
        <sequence taxon="a2" value="?000?01?0011??110010000100?000110100001??0?0010010100?00000001?0101000?10?100101110??011100?1000000111000?000??0100?001??0?101001??0000000?1?1011?000110?110010001001??001011000000?00?1001000"/>
        <sequence taxon="b1" value="?001?01?0011??110010000100?00111010000???0?001001010??00000001?0001000?10?101101100??011100?1000000111000?0000?01000001?00?101001??00000001??0011?0001100110010001001??001011000000??0??001000"/>
        <sequence taxon="b2" value="?001?01?0011??110010000100?00111010000???0?001001010??00000001?0001000?10?101101100??011100?1000000111000?0000?01000001?00?101001??00000001??0011?0001100110010001001??001011000000?00??001000"/>
        <sequence taxon="b3" value="1000?010?0?1??110010000100?01111010001??00?0010000100?00000001?0001100?00?101101110??011100?1000000111000?0000?01000001?00?101001??000001011?0011??001100110110011001??001011000000?0001001000"/>
        <sequence taxon="b4" value="??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????"/>
        <sequence taxon="c1" value="?000?01??011??110010000100?00111010001???0?0010010100?00000001?0001100??0?101101110??011100?1?00000111000?0000?01000001?00?10?001?0000001001?0011??001100010010001001??001011000000?00?1001000"/>
        <sequence taxon="c2" value="1001?011?011??1100100?0101?0011101?001??00?0010010100?00000001?0001100?10?101101110??011100??000000111000?0?00?01000001?00?10100101000001010?0011??001100110110011001??001011000100?00?1001000"/>
    </data>
    <data id="gene4" name="alignment" dataType="twoStateCovarion">
        <sequence taxon="a1" value="1010?0?010001110?01101001011?1100000??1?01?00?0?01????000?001?00?010000001001101??0010100??001001?00001000??0100000?01??0?10??1?01100???0?0000?100000?0??00?11101110100000011000110?00000?1000"/>
        <sequence taxon="a2" value="1010?0?010001110?01101001011?1100000??1?01?00?0?01????000?001?00?010000001001101??0010100??001001?00001000??0100000?01??0?10??1?01100???0?0000?100000?0??00?11101110100000011000110?00000?1000"/>
        <sequence taxon="b1" value="1000?0?010001110?011010010?1?0100010??1?00?00?0?01????00??001?0???10000?01?0110???00?1100??001100?00?01000??0100000?01??0?10??1?01100???0?0001?1000?0?01?00?1110111?100010011000110?00100?0110"/>
        <sequence taxon="b2" value="1010?0?010001110?01101001011?0100000??1?01?00?0?01????000?001?00?010000001001101??0010100??001000?00001000??0100000?01??0?10??1?01100???0?0000?100000?0??00?11101110100000011000110?00000?1000"/>
        <sequence taxon="b3" value="1010?0?010001110?01101001011?0100000??1?01?00?0?01????000?001?00?010000001001101??0010100??001000?00001000??0100000?01??0?10??1?01100???0?0000?100000?0??00?11101110100000011000110?00000?1000"/>
        <sequence taxon="b4" value="1000?0?010001110?011010010?1?0100010??1?00?00?0?01????00??001?0??010000?0??0110???00?1100??001100000?01000??0100000?01??0?10?01?01100???0?0001?1000?0?01?00?1010111?100010011000110?00100?0010"/>
        <sequence taxon="c1" value="1000?0?01000?110?0100100100100100010??1?01?00?0?01????000?001?00?010000001?01001??00??100??001?00?001010001?0100000?01??0?10??1?01100?1?0?0000?100000?0??00?11101110100000011000110?0000001010"/>
        <sequence taxon="c2" value="1000?0?01000?110?0100100100100100010??1?01?00?0?01????000?001?00?010000001?01001??00??100??001?00?001010001?0100000?01??0?10??1?01100?1?0?0000?100000?0??00?11101110100000011000110?0000001010"/>
    </data>

  <branchRateModel clock.rate="@clockRate.c:default" id="StrictClockModel.c:default" spec="beast.evolution.branchratemodel.StrictClockModel" />

              <substModel alpha="@vocabulary:covarion_alpha.s" id="covarion" spec="BinaryCovarion" switchRate="@vocabulary:covarion_s.s" vfrequencies="@vocabulary:visiblefrequencies.s">
                <parameter dimension="2" id="vocabulary:hiddenfrequencies.s" lower="0.0" name="hfrequencies" upper="1.0">0.5 0.5</parameter>
                <frequencies frequencies="0.5 0.5" id="vocabulary:dummyfrequences.s" spec="Frequencies" />
              </substModel>

    <map name="Uniform">beast.math.distributions.Uniform</map>
    <map name="Exponential">beast.math.distributions.Exponential</map>
    <map name="LogNormal">beast.math.distributions.LogNormalDistributionModel</map>
    <map name="Normal">beast.math.distributions.Normal</map>
    <map name="Beta">beast.math.distributions.Beta</map>
    <map name="Gamma">beast.math.distributions.Gamma</map>
    <map name="LaplaceDistribution">beast.math.distributions.LaplaceDistribution</map>
    <map name="InverseGamma">beast.math.distributions.InverseGamma</map>
    <map name="OneOnX">beast.math.distributions.OneOnX</map>
    <map name="prior">beast.math.distributions.Prior</map>

    <init spec="beast.util.TreeParser" id="newick:species" IsLabelledNewick="true" adjustTipHeights="false"
          newick="(((A:0.02,(B:0.01)#H1[&amp;gamma=0.3]:0.01)S1:0.03,(#H1:0.02,C:0.03)S2:0.02)R:0.05)"/>
    <run id="mcmc" spec="MCMC" chainLength="200000000" storeEvery="10000">
        <state id="state">
            <stateNode id="network:species" spec="speciesnetwork.NetworkParser" tree="@newick:species">
                <taxonset id="taxonsuperset" spec="TaxonSet">
                    <taxon id="A" spec="TaxonSet">
                        <taxon id="a1" spec="Taxon"/>
                        <taxon id="a2" spec="Taxon"/>
                    </taxon>
                    <taxon id="B" spec="TaxonSet">
                        <taxon id="b1" spec="Taxon"/>
                        <taxon id="b2" spec="Taxon"/>
                        <taxon id="b3" spec="Taxon"/>
                        <taxon id="b4" spec="Taxon"/>
                    </taxon>
                    <taxon id="C" spec="TaxonSet">
                        <taxon id="c1" spec="Taxon"/>
                        <taxon id="c2" spec="Taxon"/>
                    </taxon>
                </taxonset>
            </stateNode>
            <parameter id="originTime:species" lower="0.0" name="stateNode">0.1</parameter>
            <parameter id="netDivRate:species" lower="0.0" name="stateNode">0.01</parameter>
            <parameter id="turnOverRate:species" lower="0.0" upper="1.0" name="stateNode">0.5</parameter>
            <plate range="1,2,3" var="tree">
            <stateNode id="tree:gene$(tree)" spec="speciesnetwork.EmbeddedTree">
                <taxonset id="taxonset:gene$(tree)" spec="TaxonSet" alignment="@gene1"/>
            </stateNode>
            </plate>
            <plate range="1,2,3,4" var="gene">
            <stateNode id="index$(gene)" spec="beast.core.parameter.IntegerParameter" lower="0" upper="2"> 0 </stateNode>
            </plate>

        <parameter dimension="2" id="vocabulary:visiblefrequencies.s" lower="0.0" name="stateNode" upper="1.0">0.5 0.5</parameter>
        <plate range="1,2,3,4" var="gene">
          <parameter id="featureClockRate:vocabulary:$(gene)" name="stateNode">1.0</parameter>
        </plate>
        <parameter id="featureClockRateGammaShape:vocabulary" lower="1.1" name="stateNode" upper="100.0">5.0</parameter>
        <parameter id="featureClockRateGammaScale:vocabulary" name="stateNode">0.2</parameter>
        <parameter id="vocabulary:covarion_alpha.s" lower="1.0E-4" name="stateNode" upper="1.0">0.5</parameter>
        <parameter id="vocabulary:covarion_s.s" lower="1.0E-4" name="stateNode" upper="Infinity">0.5</parameter>
        <parameter id="clockRate.c:default" name="stateNode" upper="1000.0">0.001</parameter>
        </state>

        <init id="SNI" spec="speciesnetwork.SpeciesNetworkInitializer" estimate="false" method="random" speciesNetwork="@network:species" origin="@originTime:species">
            <plate range="1,2,3" var="tree">
            <geneTree idref="tree:gene$(tree)"/>
            </plate>
            <rebuildEmbedding id="initEmbed" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="0.0">
                <plate range="1,2,3" var="tree">
                <geneTree idref="tree:gene$(tree)"/>
                </plate>
            </rebuildEmbedding>
        </init>

        <distribution id="posterior" spec="util.CompoundDistribution">
            <distribution id="coalescent" spec="speciesnetwork.MultispeciesCoalescent" speciesNetwork="@network:species">
                <plate range="1,2,3" var="tree">
                <geneTreeWithin id="geneTree:gene$(tree)" spec="speciesnetwork.GeneTreeInSpeciesNetwork" speciesNetwork="@network:species" geneTree="@tree:gene$(tree)"/>
                </plate>
                <!-- populationModel id="popModel" popSizes="@popSizes" spec="speciesnetwork.ConstantPopulation"/ -->
                <populationModel id="popModel" alpha="4.0" beta="0.04" spec="speciesnetwork.ConstantPopIntegrated"/>
            </distribution>
            <distribution id="prior" spec="util.CompoundDistribution">
                <distribution id="networkPrior" spec="speciesnetwork.BirthHybridizationModel" network="@network:species" netDiversification="@netDivRate:species" turnOver="@turnOverRate:species" betaShape="1.0"/>
                <prior id="networkOrigin" name="distribution" x="@originTime:species">
                    <LogNormal M="-6.907755278982137" S="2.302585092994046" id="exponential.0" name="distr" offset="0.0" />
                </prior>
                <prior id="netDivPrior" name="distribution" x="@netDivRate:species">
                    <Exponential id="exponential.01" name="distr" mean="0.01"/>
                </prior>
                <prior id="turnOverPrior" name="distribution" x="@turnOverRate:species">
                    <Beta id="betadistr.01" name="distr" alpha="1.0" beta="0.01"/>
                </prior>
          <prior id="featureClockRatePrior.s:vocabulary" name="distribution">
            <input id="featureClockRateCompound:vocabulary" name="x" spec="beast.core.parameter.CompoundValuable">
              <plate range="1,2,3,4" var="gene">
                <var idref="featureClockRate:vocabulary:$(gene)" />
              </plate>
            </input>
            <input alpha="@featureClockRateGammaShape:vocabulary" beta="@featureClockRateGammaScale:vocabulary" id="featureClockRatePriorGamma:vocabulary" name="distr" spec="beast.math.distributions.Gamma" />
          </prior>
            </distribution>
            <distribution id="likelihood" spec="util.CompoundDistribution">
                <plate range="1,2,3,4" var="gene" >
          <distribution id="likelihood:gene$(gene)" data="@gene$(gene)" branchRateModel="@StrictClockModel.c:default" spec="TreeLikelihood" useAmbiguities="true">
                    <tree id="selector$(gene)" spec="speciesnetwork.TreeSelector">
                      <plate range="1,2,3" var="tree">
                      <tree idref="tree:gene$(tree)" />
                      </plate>
                      <index idref="index$(gene)" />
                    </tree>
            <siteModel id="SiteModel.vocabulary:$(gene)" mutationRate="@featureClockRate:vocabulary:$(gene)" proportionInvariant="0" shape="1" spec="SiteModel">
              <substModel idref="covarion" />
            </siteModel>
          </distribution>
                </plate>
            </distribution>
        </distribution>

        <plate range="1,2,3" var="tree">
        <operator id="scaleAndEmbed:gene$(tree)" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="3.0">
            <geneTree idref="tree:gene$(tree)"/>
            <operator id="scale:gene$(tree)" spec="ScaleOperator" scaleFactor="0.5" tree="@tree:gene$(tree)" weight="0.0"/>
        </operator>
        <operator id="scaleRootAndEmbed:gene$(tree)" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="3.0">
            <geneTree idref="tree:gene$(tree)"/>
            <operator id="scaleRoot:gene$(tree)" spec="ScaleOperator" rootOnly="true" scaleFactor="0.5" tree="@tree:gene$(tree)" weight="0.0"/>
        </operator>
        <operator id="uniformAndEmbed:gene$(tree)" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="30.0">
            <geneTree idref="tree:gene$(tree)"/>
            <operator id="uniform:gene$(tree)" spec="Uniform" tree="@tree:gene$(tree)" weight="0.0"/>
        </operator>
        <operator id="subSlideAndEmbed:gene$(tree)" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="15.0">
            <geneTree idref="tree:gene$(tree)"/>
            <operator id="subSlide:gene$(tree)" spec="SubtreeSlide" tree="@tree:gene$(tree)" weight="0.0"/>
        </operator>
        <operator id="narrowAndEmbed:gene$(tree)" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="15.0">
            <geneTree idref="tree:gene$(tree)"/>
            <operator id="narrow:gene$(tree)" spec="Exchange" tree="@tree:gene$(tree)" weight="0.0"/>
        </operator>
        <operator id="wideAndEmbed:gene$(tree)" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="5.0">
            <geneTree idref="tree:gene$(tree)"/>
            <operator id="wide:gene$(tree)" spec="Exchange" isNarrow="false" tree="@tree:gene$(tree)" weight="0.0"/>
        </operator>
        <operator id="WilsonBaldingAndEmbed:gene$(tree)" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="5.0">
            <geneTree idref="tree:gene$(tree)"/>
            <operator id="WilsonBalding:gene$(tree)" spec="WilsonBalding" tree="@tree:gene$(tree)" weight="0.0"/>
        </operator>
        </plate>

        <operator id="divrRateScale:species" spec="ScaleOperator" parameter="@netDivRate:species" scaleFactor="0.5" weight="10.0"/>
        <operator id="turnOverScale:species" spec="ScaleOperator" parameter="@turnOverRate:species" scaleFactor="0.5" weight="10.0"/>
        <operator id="gammaProbUniform:species" spec="speciesnetwork.operators.GammaProbUniform" speciesNetwork="@network:species" weight="20.0"/>
        <operator id="gammaProbRndWalk:species" spec="speciesnetwork.operators.GammaProbRndWalk" speciesNetwork="@network:species" weight="20.0"/>

        <operator id="networkMultiplier:species" spec="speciesnetwork.operators.NetworkMultiplier" speciesNetwork="@network:species" origin="@originTime:species" weight="10.0">
            <plate range="1,2,3" var="tree">
            <geneTree idref="tree:gene$(tree)"/>
            </plate>
        </operator>
        <operator id="originMultiplier:species" spec="speciesnetwork.operators.OriginMultiplier" speciesNetwork="@network:species" origin="@originTime:species" weight="5.0"/>
        <operator id="coordNodeUniformAndEmbed:species" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="80.0">
            <plate range="1,2,3" var="tree">
            <geneTree idref="tree:gene$(tree)"/>
            </plate>
            <operator id="coordNodeUniform:species" spec="speciesnetwork.operators.CoordinatedNodeUniform" speciesNetwork="@network:species" weight="0.0">
                <plate range="1,2,3" var="tree">
                <geneTree idref="tree:gene$(tree)"/>
                </plate>
            </operator>
        </operator>
        <operator id="nodeSliderAndEmbed:species" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="80.0">
            <plate range="1,2,3" var="tree">
            <geneTree idref="tree:gene$(tree)"/>
            </plate>
            <operator id="nodeSlider:species" spec="speciesnetwork.operators.NodeSlider" speciesNetwork="@network:species" origin="@originTime:species" isNormal="true" sigma="0.005" weight="0.0"/>
        </operator>

        <operator id="relocateBranchAndEmbed:species" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="150.0">
            <plate range="1,2,3" var="tree">
            <geneTree idref="tree:gene$(tree)"/>
            </plate>
            <operator id="relocateBranch:species" spec="speciesnetwork.operators.RelocateBranch" speciesNetwork="@network:species" weight="0.0"/>
        </operator>
        <operator id="flipReticulationAndEmbed:species" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="15.0">
            <plate range="1,2,3" var="tree">
            <geneTree idref="tree:gene$(tree)"/>
            </plate>
            <operator id="flipReticulation:species" spec="speciesnetwork.operators.FlipReticulation" speciesNetwork="@network:species" weight="0.0"/>
        </operator>
        <operator id="addReticulationAndEmbed:species" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="80.0">
            <plate range="1,2,3" var="tree">
            <geneTree idref="tree:gene$(tree)"/>
            </plate>
            <operator id="addReticulation:species" spec="speciesnetwork.operators.AddReticulation" speciesNetwork="@network:species" weight="0.0"/>
        </operator>
        <operator id="deleteReticulationAndEmbed:species" spec="speciesnetwork.operators.RebuildEmbedding" speciesNetwork="@network:species" taxonset="@taxonsuperset" weight="80.0">
            <plate range="1,2,3" var="tree">
            <geneTree idref="tree:gene$(tree)"/>
            </plate>
            <operator id="deleteReticulation:species" spec="speciesnetwork.operators.DeleteReticulation" speciesNetwork="@network:species" weight="0.0"/>
        </operator>
        <plate range="1,2,3,4" var="gene">
        <operator id="changeTree:$(gene)" spec="beast.evolution.operators.UniformOperator" parameter="@index$(gene)" weight="100" />
        </plate>
        
      <operator delta="0.01" id="vocabulary:covarion_frequency_sampler.s" parameter="@vocabulary:visiblefrequencies.s" spec="DeltaExchangeOperator" weight="1.0" />
      <operator id="clockScaler.c:default" parameter="@clockRate.c:default" scaleFactor="0.5" spec="ScaleOperator" weight="3.0" />

        <logger id="screenlog" logEvery="10000" model="@posterior">
            <log idref="posterior"/>
            <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
            <log idref="likelihood"/>
            <log idref="prior"/>
            <log idref="coalescent"/>
            <plate range="1,2,3,4" var="gene">
            <log idref="index$(gene)" />
            </plate>
        </logger>
        <logger id="tracelog" fileName="test_3s.xml.trace.log" logEvery="1000" model="@posterior" sort="smart">
            <log idref="posterior"/>
            <log idref="likelihood"/>
            <log idref="prior"/>
            <log idref="coalescent"/>
            <log idref="netDivRate:species"/>
            <log idref="turnOverRate:species"/>
            <log idref="originTime:species"/>
            <log id="height:species" speciesNetwork="@network:species" spec="speciesnetwork.NetworkStatLogger"/>
            <plate range="1,2,3" var="tree">
            <log id="height:gene$(tree)" tree="@tree:gene$(tree)" spec="beast.evolution.tree.TreeStatLogger"/>
            </plate>
        </logger>
        <logger id="specieslog" fileName="test_3s.xml.species.trees" logEvery="1000" mode="tree">
            <log id="networkLogger:species" spec="speciesnetwork.NetworkWithMetaDataLogger" speciesNetwork="@network:species"/>
        </logger>
        <plate range="1,2,3" var="tree">
        <logger id="treelog:gene$(tree)" fileName="test_3s.xml.gene$(tree).trees" logEvery="1000" mode="tree">
            <log id="treeLogger:gene$(tree)" tree="@tree:gene$(tree)" spec="beast.evolution.tree.TreeWithMetaDataLogger"/>
        </logger>
        </plate>
    </run>
</beast>
